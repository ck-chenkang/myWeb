## CSS的层叠性

很多公司如果要笔试，那么一定会考层叠性。

### 层叠性：计算权重

**层叠性：就是css处理冲突的能力。** 所有的权重计算，没有任何兼容问题！

CSS像艺术家一样优雅，像工程师一样严谨。

我们来看一个例子，就知道什么叫层叠性了。

[![img](Imag/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732355f323133322e706e67)](https://camo.githubusercontent.com/223f113fad17c7620db6a5e3a70b05f5715cb0ff4965e52d556c8a9a20d4c398/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732355f323133322e706e67)

上图中，三种选择器同时给P标签增加颜色的属性，但是，文字最终显示的是蓝色，这个时候，就出现了层叠性的情况。

当多个选择器，选择上了某个元素的时候，要按照如下顺序统计权重：

- id 选择器
- 类选择器、属性选择器、伪类选择器
- 标签选择器、伪元素选择器

因为对于相同方式的样式表，其选择器排序的优先级为：ID选择器 > 类选择器 > 标签选择器

针对上面这句话，我们接下来举一些复杂一点的例子。

### 层叠性举例

#### 举例1：计算权重

[![img](Imag/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732355f323133382e706e67)](https://camo.githubusercontent.com/ad73ac426109b9ffbb5e0777637060a5551b456c614a6b536949679052b90626/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732355f323133382e706e67)

如上图所示，统计各个选择器的数量，优先级高的胜出。文字的颜色为红色。

PS：不进位，实际上能进位（奇淫知识点：255个标签，等于1个类名）但是没有实战意义！

#### 举例2：权重相同时

[![img](Imag/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732355f323235302e706e67)](https://camo.githubusercontent.com/6920cd4e5f89e6232e3b998e7fc50391151a4a3d5f2e4f08009505886ad713b0/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732355f323235302e706e67)

上图可以看到，第一个样式和第二个样式的权重相同。但第二个样式的书写顺序靠后，因此以第二个样式为准（就近原则）。

#### 举例3：具有实战性的例子

[![img](Imag/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732365f323232312e706e67)](https://camo.githubusercontent.com/aa61f12c57a900330b56ec97d1b619e655f835bcaca490d8556e991649472e3f/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732365f323232312e706e67)

现在我要让一个列表实现上面的这种样式：第一个li为红色，剩下的li全部为蓝色。

如果写成下面这种代码是无法实现的：

[![img](Imag/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732365f323232352e706e67)](https://camo.githubusercontent.com/e7173d0b83dc1867ff8dced3ca811fd7974f46dc17d344ee7144265d17fcd5a9/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732365f323232352e706e67)

无法实现的原因很简单，计算一下三个选择器的权重就清楚了，显然第二个样式被第一个样式表覆盖了。

正确的做法是：（**非常重要**）

[![img](Imag/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732365f323232392e706e67)](https://camo.githubusercontent.com/5d16669e3e6bc373602553d961e5566a41e9c243e684f60eaa047f73aa5c24ac/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732365f323232392e706e67)

上图中，第二个样式比第一个样式的权重要大。因此在实战中可以实现这种效果：**所有人当中，让某一个人为红，让其他所有人为蓝。**

这种方式好用是好用，但用好很难。

就拿上方代码来举例，为了达到这种效果，即为了防止权重不够，比较稳妥的做法是：**把第二个样式表照着第一个样式表来写，在此基础上，给第二个样式表再加一个权重。**

上面这个例子很具有实战性。

#### 举例4：继承性造成的影响

这里需要声明一点：

> 如果不能直接选中某个元素，通过继承性影响的话，那么权重是0。

为了验证上面这句话，我们来看看下面这样的例子：

[![img](Imag/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f303834332e706e67)](https://camo.githubusercontent.com/35e4ad0d57bcf49e0d06188c4c7cc9792edb8881b10e7165cc34cf703a5b7305/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f303834332e706e67)

另外：**如果大家的权重相同，那么就采用就近原则：谁描述的近，听谁的**。举例如下：(box3 描述得最近，所以采用 box3 的属性)

[![img](Imag/687474703a2f2f696d672e736d79687661652e636f6d2f32303139303132325f313533302e706e67)](https://camo.githubusercontent.com/c0791f7afafe4f825f462afbfb049ac6d468a219bc85fd6c5a840a5da2c67a08/687474703a2f2f696d672e736d79687661652e636f6d2f32303139303132325f313533302e706e67)

上方代码的文字版如下：

```
<!DOCTYPE html>
<html lang="">
  <head>
    <meta />
    <meta />
    <meta />
    <title>Document</title>
    <style>
      #box1 {
        color: red;
      }

      #box2 {
        color: green;
      }

      #box3 {
        color: blue;
      }
    </style>
  </head>
  <body>
    <div id="box1">
      <div id="box2">
        <div id="box3"><p>猜猜我是什么颜色</p></div>
      </div>
    </div>
  </body>
</html>
```

### 层叠性：权重计算的问题大总结（非常重要）

层叠性。层叠性是一种能力，就是处理冲突的能力。当不同选择器，对一个标签的同一个样式，有不同的值，听谁的？这就是冲突。css有着严格的处理冲突的机制。

通过列举上面几个例子，我们对权重问题做一个总结。

[![img](Imag/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f323035302e706e67)](https://camo.githubusercontent.com/793b50a0dc02f26dee9232ca152854e31c9a11455e1ea5453970b396d15685a4/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f323035302e706e67)

上面这个图非常重要，我们针对这个图做一个文字描述：

- 选择上了，数权重，(id的数量，类的数量，标签的数量)。如果权重一样，谁写在后面听谁的。
- 没有选择上，通过继承影响的，就近原则，谁描述的近听谁的。如果描述的一样近，比如选择器权重，如果权重再一样重，谁写在后面听谁的。

### CSS样式表的冲突的总结

- 1、对于相同的选择器（比如同样都是类选择器），其样式表排序：行级样式 > 内嵌样式表 > 外部样式表（就近原则）
- 2、对于相同类型的样式表（比如同样都是内部样式表），其选择器排序：ID选择器 > 类选择器 > 标签选择器
- 3、外部样式表的ID选择器 > 内嵌样式表的标签选择器

> 总结：就近原则。ID选择器优先级最大。

举例：如果都是内嵌样式表，优先级的顺序如下：（ID 选择器 > 类选择器 > 标签选择器）

[![img](Imag/687474703a2f2f696d672e736d79687661652e636f6d2f323031352d31302d30332d6373732d31342e706e67)](https://camo.githubusercontent.com/174474f2264a8d44ae80d319b7ac9b1e7a13bc1a30054e82a36859515d43687e/687474703a2f2f696d672e736d79687661652e636f6d2f323031352d31302d30332d6373732d31342e706e67)

另外还有两个冲突的情况：

- 1、对同一个标签，如果用到的都是内嵌样式表，且权重一致，那它的优先级：**定义**的CSS样式表中，谁最近，就用谁。
- 2、对于同一个标签，如果用到的都是外部样式表，且权重一致，那它的优先级：html文件中，引用样式表的位置越近，就用谁。

例如：

[![img](Imag/687474703a2f2f696d672e736d79687661652e636f6d2f323031352d31302d30332d6373732d31362e706e67)](https://camo.githubusercontent.com/af96ed2acb19f260d1edf1397a067efeca243bcb94252b7baf93f3169f34fdff/687474703a2f2f696d672e736d79687661652e636f6d2f323031352d31302d30332d6373732d31362e706e67)

### 题目演示

CSS的层叠性讲完了，我们来做几个题目吧。

#### 题目1

[![img](Imag/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f303835312e706e67)](https://camo.githubusercontent.com/8cb5c30f35d0c6b12feac159abaa8064c265571f5db927e12a87038f4d5c4288/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f303835312e706e67)

#### 题目2

[![img](Imag/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f303835332e706e67)](https://camo.githubusercontent.com/00b94dc7d93f35ca3133aafdd47674e7c98aa0e11274737f81b1c67982b10e1c/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f303835332e706e67)

#### 题目3

[![img](Imag/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f303835352e706e67)](https://camo.githubusercontent.com/0516356c969b4cf55781166bf8919185ceb8415fc52b5ecf10f8eb4c2b9edca2/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f303835352e706e67)

#### 题目4

[![img](Imag/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f303835372e706e67)](https://camo.githubusercontent.com/17a954190c0735bc0aabf6c1415cef9330217a123f89a54fe44d60c4e5de25a6/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f303835372e706e67)

## 权重问题深入

### 同一个标签，携带了多个类名，有冲突：

这里需要补充两种冲突的情况：

- 1、对同一个标签，如果用到了了多个相同的内嵌样式表，它的优先级：**定义**的样式表中，谁最近，就用谁。
- 2、对于同一个标签，如果引用了多个相同的外部样式表，它的优先级：html文件中，引用样式表的位置越近，就用谁。

例如：（就近原则）

[![img](Imag/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f323032312e706e67)](https://camo.githubusercontent.com/4044aaad8a18625ad3f73ec3653351c4c46d25a4753aa8131a205fdd34879e6c/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f323032312e706e67)

上图中，**文字显示的颜色均为红色**。因为这和在标签中的挂类名的书序无关，只和css的顺序有关。

### !important标记：优先级最高

来看个很简单的例子：

[![img](Imag/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f323032392e706e67)](https://camo.githubusercontent.com/5b875451cf163e524efa54646eef026c22c76203572fa11cc91fce34f695be97/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f323032392e706e67)

上图中，显然id选择器的权重最大，所以文字的颜色是红色。

如果我们想让文字的颜色显示为绿色，只需要给标签选择器的加一个`!important`标记，此时其权重为无穷大。如下：

[![img](Imag/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f323033355f322e706e67)](https://camo.githubusercontent.com/7dd3f4528f5e384cf1ba5234a92fe30087d7428e6a5679fc154c527efd07c62d/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f323033355f322e706e67)

important是英语里面的“重要的”的意思。我们可以通过如下语法：

```
k:v !important;
```

来给一个属性提高权重。这个属性的权重就是**无穷大**。

注意，一定要注意语法的正确性。

正确的语法：

```
font-size:60px !important;
```

错误的语法：

```
font-size:60px; !important;    不能把!important写在外面
font-size:60px important;      不能忘记感叹号
```

`!important`标记需要强调如下3点：

**（1）!important提升的是一个属性，而不是一个选择器**

```
		p{
			color:red !important;    只写了这一个!important，所以只有字体颜色属性提升了权重
			font-size: 100px ;       这条属性没有写!important，所以没有提升权重
		}
		#para1{
			color:blue;
			font-size: 50px;
		}
		.spec{
			color:green;
			font-size: 20px;
		}
```

所以，综合来看，字体颜色是red（听important的）；字号是50px（听id的）。

**（2）!important无法提升继承的权重，该是0还是0**

比如HTML结构：

```
	<div>
		<p>哈哈哈哈哈哈哈哈</p>
	</div>
```

有CSS样式：

```
	div{
		color:red !important;
	}
	p{
		color:blue;
	}
```

由于div是通过继承性来影响文字颜色的，所以!important无法提升它的权重，权重依然是0。

干不过p标签，因为p标签是实实在在选中了，所以字是蓝色的（以p为准）。

**(3)!important不影响就近原则**

如果大家都是继承来的，按理说应该按照“就近原则”，那么important能否影响就近原则呢？ 答案是：不影响。远的，永远是远的。不能给远的写一个important，干掉近的。

为了验证这个问题，我们可以搞两层具有继承性的标签，然后给外层标签加一个!important，最终看看就近原则有没有被打破。举例如下：

[![img](Imag/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f323034362e706e67)](https://camo.githubusercontent.com/ef4e93a644a1cc541687bb040184271fe968105dccd26ae889f1d35b2f328b5c/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f323034362e706e67)

PS：做网站的时候，!important 尽量不要用。否则会让css写的很乱。

## 知识回顾

> 我们把以上内容和上一篇文章做一个简单的知识回顾。

### CSS属性

> css属性，面试的时候会有笔试，笔试没有智能提示的。

加粗，倾斜，下划线：

```
font-weight:bold;
font-style:italic;
text-decoration:underline;
```

背景颜色、前景色：

```
background-color:red;
color:red;
```

### class和id的区别

class用于css的，id用于js的。

1）class页面上可以重复。id页面上唯一，不能重复。 2）一个标签可以有多个class，用空格隔开。但是id只能有id。

### 各种选择器(浏览器兼容性)

IE6层面兼容的选择器： 标签选择器、id选择器、类选择器、后代、交集选择器、并集选择器、通配符。如下：

```
p
#box
.spec
div p
div.spec
div,p
*
```

IE7能够兼容的：儿子选择器、下一个兄弟选择器。如下：

```
div>p
h3+p
```

IE8能够兼容的：

```
ul li:first-child
ul li:last-child
```

### css两个性质

- 继承性：好的事儿。继承从上到下，哪些能？哪些不能？
- 层叠性：冲突，多个选择器描述了同一个属性，听谁的？

再看几个题目：

[![img](Imag/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f303930302e706e67)](https://camo.githubusercontent.com/8660a8c68bdd59f96b0a38caeb7536a7c7d65e1c5e4051e5b23f415d8c984ffe/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f303930302e706e67)

[![img](Imag/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f303930312e706e67)](https://camo.githubusercontent.com/4fe27fcff2f05ae349dce2a3984f91da040c00d673bd61d868d8c38cc677d56d/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f303930312e706e67)

[![img](Imag/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f303930322e706e67)](https://camo.githubusercontent.com/9e7560f229d8a5dc0f19706abcf7bc6e8c4699001f1057ccb39ffe50ea3efbc9/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f303930322e706e67)

[![img](Imag/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f303930332e706e67)](https://camo.githubusercontent.com/4362824ae9fe3732d12a6f4aa4423cbd14def97c68c92778b4d7f4c5b07e6f0d/687474703a2f2f696d672e736d79687661652e636f6d2f32303137303732375f303930332e706e67)

## 